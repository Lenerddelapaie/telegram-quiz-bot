<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Quiz â€” ÃŠtes-vous fait pour Ãªtre gestionnaire de paie ? | La Paie Facile</title>
  <meta name="description" content="DÃ©couvrez si le mÃ©tier de gestionnaire de paie est fait pour vous grÃ¢ce Ã  ce quiz interactif La Paie Facile.">

  <style>
    :root { --green:#2AFF00; }
    body { margin:0; background:#fff; color:#111; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }

    /* ===== Zone Quiz ===== */
    #lpf-quiz-root { color:#111; max-width:860px; margin:32px auto; padding:0 16px; }
    #lpf-quiz-root * { box-sizing:border-box; }
    #lpf-quiz-root .lpf-card { background:#fff; border:6px solid #000; border-radius:24px; padding:24px 20px; margin:20px 0; box-shadow:0 6px 0 rgba(0,0,0,.06); }
    #lpf-quiz-root h2 { font-size:1.6rem; margin:0 0 10px; }
    #lpf-quiz-root p { line-height:1.55; }

    /* Progression */
    #lpf-quiz-root .lpf-progress { display:flex; gap:10px; align-items:center; margin: 12px 0 8px; }
    #lpf-quiz-root .lpf-progress-bar { flex:1; background:#eee; height:10px; border-radius:6px; border:2px solid #000; position:relative; }
    #lpf-quiz-root .lpf-progress-bar span { display:block; background:var(--green); height:100%; border-radius:4px; transition: width .2s ease; width:0%; }
    #lpf-quiz-root .lpf-progress-label { min-width:120px; font-weight:800; text-align:right; }

    /* Micro-intros */
    #lpf-quiz-root .lpf-section-intro { border:3px dashed #000; border-radius:16px; padding:12px 14px; margin:12px 0; background:#f9f9f9; font-weight:600; }

    /* Questions & options */
    #lpf-quiz-root .lpf-question { font-weight:800; font-size:1.14rem; margin-bottom:12px; }
    #lpf-quiz-root fieldset { border:0; padding:0; margin:0; }
    #lpf-quiz-root legend.lpf-question { padding:0; }
    #lpf-quiz-root .lpf-options { display:grid; gap:10px; }
    #lpf-quiz-root .lpf-option { display:flex; gap:10px; align-items:flex-start; padding:12px 14px; border:2px solid #000; border-radius:12px; background:#fff; cursor:pointer; transition: transform .08s ease; }
    #lpf-quiz-root .lpf-option:hover { transform: translateY(-1px); }
    #lpf-quiz-root .lpf-option input { margin-top:2px; }
    #lpf-quiz-root .lpf-option:has(input:checked) { outline:3px solid #000; outline-offset:2px; box-shadow:0 0 0 3px rgba(0,0,0,.05) inset; }
    .no-has #lpf-quiz-root .lpf-option.is-checked { outline:3px solid #000; outline-offset:2px; box-shadow:0 0 0 3px rgba(0,0,0,.05) inset; }

    /* Boutons */
    #lpf-quiz-root .lpf-btn { background:var(--green); color:#000; font-weight:900; font-size:1.06rem; padding:12px 18px; border:none; border-radius:12px; cursor:pointer; box-shadow:0 3px 0 rgba(0,0,0,.7); transition: transform .12s, background .12s; }
    #lpf-quiz-root .lpf-btn:hover { background:#20de00; transform: translateY(-1px); }
    #lpf-quiz-root .lpf-btn.ghost { background:#fff; border:2px solid #000; box-shadow:none; font-weight:800; }
    #lpf-quiz-root .lpf-btn[disabled] { opacity:.5; cursor:not-allowed; }
    #lpf-quiz-root .lpf-btn:focus-visible, #lpf-quiz-root .lpf-option:focus-visible { outline:3px solid #000; outline-offset:3px; border-radius:10px; }

    /* Actions: Continuer + Revenir (lien) */
    #lpf-quiz-root .lpf-actions { display:flex; gap:10px; justify-content:flex-end; margin-top:18px; }
    #lpf-quiz-root .lpf-actions--quiz { flex-direction:column; align-items:flex-end; gap:6px; }
    #lpf-quiz-root .lpf-back-link { font-size:.92rem; background:none; border:0; padding:0; color:#111; text-decoration:underline; cursor:pointer; }
    #lpf-quiz-root .lpf-back-link[disabled]{ opacity:.5; cursor:default; text-decoration:none; }
    #lpf-quiz-root .lpf-back-link:focus-visible{ outline:3px solid #000; outline-offset:3px; border-radius:6px; }

    /* Break & Result */
    #lpf-quiz-root .lpf-break h3 { margin:0 0 6px; }
    #lpf-quiz-root .lpf-break p { margin:6px 0; }
    #lpf-quiz-root .lpf-result h2 { margin-top:0; }
    #lpf-quiz-root .lpf-result .body { margin-top:8px; }

    /* >>> CTA centrÃ©s sur les Ã©crans "Voir mon rÃ©sultat" et "Poursuivreâ€¦" <<< */
    #lpf-quiz-root .lpf-result .lpf-actions,
    #lpf-quiz-root .lpf-break .lpf-actions{
      justify-content:center;
    }

    /* ===== Modal (email capture) ===== */
    .lpf-modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,.55); z-index:999; display:none; }
    .lpf-modal-backdrop[aria-hidden="false"]{ display:block; }

    .lpf-modal { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:1000; pointer-events:none; padding:16px; }
    .lpf-modal[aria-hidden="false"]{ pointer-events:auto; }

    .lpf-dialog {
      width:min(680px, 92vw);
      background:#fff; border:6px solid #000; border-radius:20px; box-shadow:0 10px 40px rgba(0,0,0,.25);
      padding:20px 18px;
      transform:translateY(10px); transition:transform .16s ease, opacity .16s ease;
      opacity:0;
    }
    .lpf-modal[aria-hidden="false"] .lpf-dialog{ transform:translateY(0); opacity:1; }

    .lpf-dialog header{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:6px; }
    .lpf-dialog h3{ margin:0; font-size:1.25rem; }
    .lpf-close { background:#fff; border:2px solid #000; border-radius:10px; padding:6px 10px; cursor:pointer; font-weight:800; }
    body.lpf-no-scroll{ overflow:hidden; }

    /* ---- Bloc progression du modal : largeur propre ---- */
    #progress-block{ display:none; max-width:100%; width:100%; margin:18px 0 0; }
    #progress-block .row{ display:flex; gap:10px; align-items:center; }
    #progress-bar{ flex:1; background:#eee; height:12px; border-radius:8px; border:2px solid #000; position:relative; width:100%; }
    #progress-fill{ display:block; background:var(--green); height:100%; border-radius:6px; width:0%; transition:width .2s ease; }
    #progress-label{ min-width:90px; font-weight:800; text-align:right; }
    #progress-text{ margin:8px 0 0; font-weight:700; }
    #lpf-email-modal .feedback{ margin-top:8px; }

    @media (prefers-reduced-motion: reduce){ #lpf-quiz-root * { transition:none!important; animation:none!important; } }
    @media (max-width:560px){
      #lpf-quiz-root .lpf-actions { flex-direction:column; }
      #lpf-quiz-root .lpf-btn, #lpf-quiz-root .lpf-btn.ghost { width:100%; }
      #lpf-quiz-root .lpf-actions--quiz { align-items:stretch; }
      #lpf-quiz-root .lpf-back-link { text-align:right; }
    }
  </style>
</head>

<body>
  <div id="lpf-quiz-root"></div>

  <script>
  (function(){
    /* ====== PARAMS ====== */
    const PROG = [20,30,40,50,55,60,70,75,80,85,95,100];

    /* DÃ©tection support :has() (fallback .no-has) */
    if (!CSS.supports('selector(:has(*))')) {
      document.documentElement.classList.add('no-has');
    }

    /* Contenus d'intro */
    const TEXT = {
      start: {
        title: "Quiz Â« ÃŠtes-vous fait pour Ãªtre gestionnaire de paie ? Â»",
        body: [
          "DÃ©couvrez ce qui vous motive vraiment au travail et si le mÃ©tier de gestionnaire de paie vous correspond.",
          "Â« Tout le monde sait ce quâ€™il faitâ€¦ mais trÃ¨s peu savent pourquoi ils le font. Â» â€” Simon Sinek",
          "Avant de choisir votre prochaine Ã©tape professionnelle, prenez un moment pour comprendre ce qui vous anime vraiment.",
          "Ce quiz interactif vous invite Ã  un voyage simple et puissant pour avancer avec clartÃ© et confiance.",
          "Ce nâ€™est pas un test ordinaire : câ€™est un outil pour vous reconnecter Ã  ce qui vous anime profondÃ©ment."
        ],
        cta: "ğŸš€ Câ€™est parti"
      },
      instructions: {
        title: "Avant de commencer",
        ps: [
          "Ce quiz comprend <strong>une dizaine de questions simples</strong>, Ã  complÃ©ter en <strong>3 Ã  5 minutes</strong>.",
          "Ã€ chaque Ã©tape, choisissez la rÃ©ponse <strong>qui vous correspond le mieux</strong>.",
          "Il nâ€™y a <strong>ni bonnes ni mauvaises rÃ©ponses</strong> : chacune rÃ©vÃ¨le une part de votre force.",
          "Une <strong>barre de progression</strong> vous montre votre avancement : chaque Ã©tape franchie vous rapproche du rÃ©sultat.",
          "âš ï¸ Pour un portrait fiable, <strong>rÃ©pondez Ã  toutes les questions</strong>.",
          "Ã€ la fin, vous recevrez votre <strong>profil expliquÃ©</strong>, le <strong>danger Ã  Ã©viter</strong> et le <strong>guide complet</strong> pour rÃ©ussir concrÃ¨tement.",
          "<em>Câ€™est rapide, simple et 100 % confidentiel.</em>"
        ],
        cta: "ğŸ¯ Commencer le quiz"
      },
      micro: {
        a: "RÃ©pondez spontanÃ©ment : la premiÃ¨re idÃ©e est souvent la bonne.",
        b: "Continuez sur votre lancÃ©e : vous avancez trÃ¨s bien.",
        c: "DerniÃ¨re ligne droite : votre portrait se prÃ©cise."
      },
      breaks: {
        after4: { h:"PremiÃ¨re Ã©tape rÃ©ussie", t:"Vous avez posÃ© des bases solides. Continuez : vous tenez un bon rythme.", s:"Vous avez dÃ©jÃ  parcouru 50 % du chemin." },
        after8: { h:"DeuxiÃ¨me Ã©tape complÃ©tÃ©e", t:"Plus que quelques questions pour affiner votre portrait.", s:"Vous Ãªtes dÃ©jÃ  Ã  75 % du parcours." },
        final:  { h:"Bravo, vous Ãªtes allÃ©(e) jusquâ€™au bout", t:"Votre profil est prÃªt : forces + danger Ã  Ã©viter, avec les prochaines Ã©tapes.", cta:"Voir mon rÃ©sultat" }
      }
    };

    /* Questions */
    const QUESTIONS = [
      // Bloc A (1..4)
      { id:"q1", block:"a", text:"Quâ€™est-ce qui vous motive le plus dans votre travail ?", options:[
        {label:"Contribuer Ã  la justice et Ã  lâ€™Ã©quitÃ©", profile:"gardien"},
        {label:"Organiser et mettre de lâ€™ordre", profile:"organisateur"},
        {label:"Relever des dÃ©fis et rÃ©soudre des problÃ¨mes", profile:"resolveur"},
        {label:"Communiquer et aider les autres", profile:"communicant"}
      ]},
      { id:"q2", block:"a", text:"Quelle valeur compte le plus pour vous au quotidien ?", options:[
        {label:"Lâ€™Ã©quitÃ© â€“ garantir un traitement juste", profile:"gardien"},
        {label:"Lâ€™organisation â€“ un cadre structurÃ©", profile:"organisateur"},
        {label:"La fiabilitÃ© â€“ on peut compter sur vous", profile:"collaborateur"},
        {label:"Lâ€™apprentissage â€“ Ã©voluer en continu", profile:"curieux"}
      ]},
      { id:"q3", block:"a", text:"Quâ€™est-ce qui vous attire dans la gestion de la paie ?", options:[
        {label:"Assurer une paie correcte et conforme pour tous", profile:"gardien"},
        {label:"ÃŠtre au cÅ“ur du fonctionnement et de la stabilitÃ©", profile:"organisateur"},
        {label:"MaÃ®triser un domaine technique exigeant", profile:"expert"},
        {label:"Allier chiffres et accompagnement des personnes", profile:"communicant"}
      ]},
      { id:"q4", block:"a", text:"Quâ€™est-ce qui vous donne le plus le sentiment dâ€™Ãªtre utile ?", options:[
        {label:"Aider concrÃ¨tement quelquâ€™un", profile:"collaborateur"},
        {label:"RÃ©soudre un problÃ¨me Ã©pineux", profile:"resolveur"},
        {label:"Respecter les Ã©chÃ©ances et les rÃ¨gles", profile:"organisateur"},
        {label:"Apprendre quelque chose de nouveau", profile:"curieux"}
      ]},

      // Bloc B (5..8)
      { id:"q5", block:"b", text:"Laquelle de ces phrases vous ressemble le plus au travail ?", options:[
        {label:"Je planifie mÃ©thodiquement mes tÃ¢ches", profile:"organisateur"},
        {label:"Je vÃ©rifie chaque dÃ©tail pour Ã©viter les erreurs", profile:"expert"},
        {label:"Je prends des initiatives et jâ€™avance en autonomie", profile:"strategique"},
        {label:"Je collabore et je facilite la communication", profile:"communicant"}
      ]},
      { id:"q6", block:"b", text:"Face Ã  une nouvelle tÃ¢che complexe, vous avez tendance Ã â€¦", options:[
        {label:"Vous documenter et vous former", profile:"curieux"},
        {label:"DÃ©couper en Ã©tapes structurÃ©es", profile:"organisateur"},
        {label:"Voir Ã§a comme un dÃ©fi stimulant", profile:"resolveur"},
        {label:"Demander conseil aux plus expÃ©rimentÃ©s", profile:"communicant"}
      ]},
      { id:"q7", block:"b", text:"En cas dâ€™imprÃ©vu ou dâ€™urgence, vousâ€¦", options:[
        {label:"Gardez votre calme et analysez", profile:"resolveur"},
        {label:"Priorisez et vous organisez aussitÃ´t", profile:"organisateur"},
        {label:"Informez et coordonnez lâ€™entraide", profile:"communicant"},
        {label:"Appliquez les rÃ¨gles et la technique", profile:"expert"}
      ]},
      { id:"q8", block:"b", text:"Le compliment qui vous fait le plus plaisir :", options:[
        {label:"Â« On peut toujours compter sur vous Â»", profile:"collaborateur"},
        {label:"Â« Câ€™est toujours bien organisÃ© et sans erreur Â»", profile:"organisateur"},
        {label:"Â« Vous trouvez toujours la solution Â»", profile:"resolveur"},
        {label:"Â« Votre pÃ©dagogie nous aide Ã©normÃ©ment Â»", profile:"communicant"}
      ]},

      // Bloc C (9..12)
      { id:"q9", block:"c", text:"Quelle activitÃ© vous attire le plus ?", options:[
        {label:"Analyser des chiffres et vÃ©rifier des calculs", profile:"expert"},
        {label:"Mettre en place un tableau dâ€™organisation", profile:"organisateur"},
        {label:"Expliquer un bulletin de paie Ã  un collÃ¨gue", profile:"communicant"},
        {label:"Veiller au respect des rÃ¨gles et procÃ©dures", profile:"gardien"}
      ]},
      { id:"q10", block:"c", text:"Parmi ces tÃ¢ches, laquelle prÃ©fÃ©rez-vous ?", options:[
        {label:"Le droit / la gestion", profile:"gardien"},
        {label:"La comptabilitÃ© / les mathÃ©matiques", profile:"expert"},
        {label:"Les Ã©tudes de cas complexes", profile:"resolveur"},
        {label:"Les travaux en groupe avec entraide", profile:"communicant"}
      ]},
      { id:"q11", block:"c", text:"Dans un poste administratif, vous aimez surtoutâ€¦", options:[
        {label:"La prÃ©cision des procÃ©dures", profile:"gardien"},
        {label:"AmÃ©liorer les mÃ©thodes et les outils", profile:"strategique"},
        {label:"ÃŠtre la personne rÃ©fÃ©rente sur le technique", profile:"expert"},
        {label:"Accompagner et informer les autres", profile:"communicant"}
      ]},
      { id:"q12", block:"c", text:"Ce qui vous enthousiasmerait le plus en paie :", options:[
        {label:"Garantir une paie juste et conforme", profile:"gardien"},
        {label:"Organiser le calendrier et les Ã©chÃ©ances", profile:"organisateur"},
        {label:"MaÃ®triser les dÃ©tails techniques et les logiciels", profile:"expert"},
        {label:"Conseiller les collaborateurs", profile:"communicant"}
      ]}
    ];

    /* PondÃ©rations internes */
    const WEIGHTS = { a:0.5, b:0.3, c:0.2 };
    const TIE = ["gardien","organisateur","expert","resolveur","communicant","collaborateur","strategique","curieux"];

    /* RÃ©sultats â€” CTA mis Ã  jour : "Poursuivre pour recevoir le guide" */
    const RESULTS = {
      gardien: { title:"Vous Ãªtes : Gardien de lâ€™Ã‰quitÃ©", body:`Le gestionnaire de paie est le garant de lâ€™Ã©quitÃ© au sein de lâ€™entreprise. Son rÃ´le ne se limite pas Ã  Ã©tablir des bulletins de paie : il veille Ã  ce que chaque salariÃ© reÃ§oive exactement ce qui lui est dÃ», conformÃ©ment Ã  la lÃ©gislation sociale en constante Ã©volution. Cela implique la prÃ©paration rigoureuse des salaires, la gestion prÃ©cise des dÃ©clarations sociales obligatoires, la prise en compte des absences, primes, heures supplÃ©mentaires, ainsi que le respect scrupuleux des Ã©chÃ©ances.
<br><br>Câ€™est un mÃ©tier Ã  haute responsabilitÃ©, au croisement du juridique, du technique et de lâ€™organisation, oÃ¹ chaque erreur peut avoir des consÃ©quences financiÃ¨res et humaines majeures.
<br><br>En tant que Gardien de lâ€™Ã‰quitÃ©, vous incarnez la rigueur et le sens du juste. Votre intÃ©gritÃ© vous positionne comme un pilier fiable dans un environnement oÃ¹ la prÃ©cision est essentielle pour Ã©viter les inÃ©galitÃ©s ou litiges. Votre capacitÃ© Ã  expliquer clairement les rÃ¨gles complexes aux salariÃ©s ajoute une dimension humaine prÃ©cieuse, rassurante et pÃ©dagogique.
<br><br><strong>âš ï¸ Cependant</strong>, votre quÃªte absolue de justice peut parfois gÃ©nÃ©rer du stress, surtout face Ã  lâ€™incertitude juridique ou aux subtilitÃ©s changeantes des rÃ¨gles de paie. Un paramÃ©trage oubliÃ© ou une interprÃ©tation erronÃ©e peuvent paradoxalement crÃ©er lâ€™injustice que vous souhaitez combattre.
<br><br>La clÃ© pour vous est dâ€™asseoir votre expertise sur une connaissance solide des fondamentaux associÃ©e Ã  une vision globale apaisÃ©e et structurÃ©e de la paie.
<br><br><strong>ğŸ‘‰ Appuyez sur Â« Poursuivre pour recevoir le guide Â» pour saisir votre e-mail et recevoir votre guide complet.</strong>` },
      organisateur: { title:"Vous Ãªtes : Organisateur MÃ©thodique", body:`Le gestionnaire de paie a la lourde responsabilitÃ© de piloter lâ€™ensemble des opÃ©rations liÃ©es au salaire des collaborateurs : Ã©laboration prÃ©cise des bulletins de paie, suivi rigoureux des dÃ©clarations sociales, respect impÃ©ratif des Ã©chÃ©ances mensuelles, et gestion sÃ©curisÃ©e des donnÃ©es sensibles. Au cÅ“ur de ce mÃ©tier complexe, se conjuguent des compÃ©tences techniques pointues, une connaissance fine du cadre juridique, et une organisation sans faille. Chaque Ã©lÃ©ment doit Ãªtre orchestrÃ© avec rigueur, efficacitÃ© et adaptabilitÃ© pour Ã©viter erreurs et retards coÃ»teux.
<br><br>En tant quâ€™Organisateur MÃ©thodique, votre force est votre capacitÃ© Ã  structurer, anticiper et maintenir un ordre irrÃ©prochable. Vous excellez dans la planification des tÃ¢ches et le suivi des cycles paie, des points essentiels dans un mÃ©tier rythmÃ© par des Ã©chÃ©ances prÃ©cises et contraignantes. Votre profil rÃ©vÃ¨le Ã©galement une affinitÃ© pour la prÃ©cision technique, proche du rÃ´le dâ€™expert technique, ce qui vous permet dâ€™Ãªtre aussi efficace sur la forme que sur le fond.
<br><br><strong>âš ï¸ Cependant</strong>, la gestion des imprÃ©vus â€” absences soudaines, variables de derniÃ¨re minute, Ã©volutions rÃ©glementaires frÃ©quentes â€” peut mettre Ã  lâ€™Ã©preuve votre organisation. Le succÃ¨s repose alors sur votre capacitÃ© Ã  ajuster vos prioritÃ©s, Ã  rester flexible tout en gardant le cap sur lâ€™essentiel.
<br><br><strong>ğŸ‘‰ Appuyez sur Â« Poursuivre pour recevoir le guide Â» pour saisir votre e-mail et recevoir votre guide complet.</strong>` },
      resolveur: { title:"Vous Ãªtes : RÃ©solveur de ProblÃ¨mes", body:`Le gestionnaire de paie jongle chaque mois avec un grand nombre dâ€™informations complexes : calculs prÃ©cis, variables spÃ©cifiques Ã  chaque salariÃ©, Ã©volutions lÃ©gales frÃ©quentes, dÃ©clarations sociales et corrections dâ€™anomalies. Son mÃ©tier est un subtil Ã©quilibre entre technique, rÃ©glementation et organisation, oÃ¹ chaque situation exceptionnelle demande une vigilance et une rÃ©activitÃ© accrues.
<br><br>Vous Ãªtes avant tout un RÃ©solveur de ProblÃ¨mes : vous aimez analyser en profondeur, comprendre les mÃ©canismes et surtout trouver des solutions efficaces. Cette capacitÃ© Ã  dÃ©bloquer les cas particuliers et Ã  corriger les anomalies est prÃ©cieuse dans un environnement oÃ¹ chaque dÃ©tail compte et oÃ¹ lâ€™adaptabilitÃ© est essentielle. Votre profil rÃ©vÃ¨le Ã©galement une dimension dâ€™organisateur mÃ©thodique, ce qui vous permet de ne pas perdre de vue les Ã©chÃ©ances cruciales.
<br><br><strong>âš ï¸ Toutefois</strong>, en vous concentrant trop longuement sur un problÃ¨me isolÃ©, vous risquez de perdre le fil global, ce qui pourrait compromettre le respect des dÃ©lais et fragiliser lâ€™ensemble du cycle paie.
<br><br><strong>ğŸ‘‰ Appuyez sur Â« Poursuivre pour recevoir le guide Â» pour saisir votre e-mail et recevoir votre guide complet.</strong>` },
      communicant: { title:"Vous Ãªtes : Communicant Responsable", body:`Le gestionnaire de paie ne se limite pas Ã  des chiffres dans des tableaux. Câ€™est souvent un interlocuteur privilÃ©giÃ© pour les salariÃ©s qui souhaitent comprendre leur fiche de paie, poser des questions ou Ãªtre rassurÃ©s. Ce mÃ©tier demande donc autant de compÃ©tences humaines que techniques : vous Ãªtes le lien essentiel entre la complexitÃ© rÃ©glementaire et les attentes des collaborateurs.
<br><br>Vous Ãªtes avant tout un Communicant Responsable : vous savez expliquer avec clartÃ©, Ã©couter activement et transmettre les informations de faÃ§on rassurante. Votre rÃ´le de mÃ©diateur crÃ©e un climat de confiance indispensable dans une pÃ©riode sensible oÃ¹ la paie impacte directement le quotidien des salariÃ©s. Votre profil dÃ©voile Ã©galement une bonne organisation, qui vous permet de gÃ©rer efficacement votre charge de travail tout en restant disponible.
<br><br><strong>âš ï¸ Attention</strong> cependant, votre sens du service et votre disponibilitÃ© peuvent Ãªtre source de dispersion. En voulant rÃ©pondre Ã  toutes les sollicitations, vous risquez de nÃ©gliger la rigueur technique indispensable Ã  la sÃ©curitÃ© des paies.
<br><br><strong>ğŸ‘‰ Appuyez sur Â« Poursuivre pour recevoir le guide Â» pour saisir votre e-mail et recevoir votre guide complet.</strong>` },
      expert: { title:"Vous Ãªtes : Expert Technique", body:`Le mÃ©tier de gestionnaire de paie repose sur une maÃ®trise technique pointue. Il s'agit de gÃ©rer des rÃ¨gles juridiques complexes, d'effectuer des calculs prÃ©cis des cotisations sociales, de paramÃ©trer avec rigueur des logiciels spÃ©cialisÃ©s, et de garantir la conformitÃ© avec les lois et conventions collectives. Dans ce domaine, chaque dÃ©tail a son importance et peut avoir des consÃ©quences majeures, tant pour lâ€™entreprise que pour les salariÃ©s.
<br><br>Vous Ãªtes avant tout un Expert Technique : vous aimez comprendre en profondeur les rÃ¨gles, vÃ©rifier minutieusement les chiffres, et produire des documents impeccables. Votre rigueur et votre souci du dÃ©tail font de vous un pilier indispensable dans la chaÃ®ne de la paie. Votre profil rÃ©vÃ¨le aussi une capacitÃ© dâ€™analyse forte, un atout prÃ©cieux pour dÃ©tecter et rÃ©soudre rapidement les anomalies.
<br><br><strong>âš ï¸ Cependant</strong>, votre immersion dans la complexitÃ© technique peut parfois vous faire perdre la vision dâ€™ensemble et vous isoler dans les dÃ©tails, au risque de passer Ã  cÃ´tÃ© des enjeux plus globaux.
<br><br><strong>ğŸ‘‰ Appuyez sur Â« Poursuivre pour recevoir le guide Â» pour saisir votre e-mail et recevoir votre guide complet.</strong>` },
      strategique: { title:"Vous Ãªtes : StratÃ©gique Visionnaire", body:`Le gestionnaire de paie ne se limite plus Ã  un simple rÃ´le technique. Il est aujourdâ€™hui un acteur clÃ© de la performance globale de lâ€™entreprise. Au-delÃ  de la prÃ©paration des bulletins de salaire, il optimise les processus, pilote les outils numÃ©riques, anticipe les Ã©volutions rÃ©glementaires, et contribue aux stratÃ©gies de Ressources Humaines. Son expertise nourrit les dÃ©cisions stratÃ©giques pour garantir la conformitÃ©, la satisfaction des collaborateurs et la stabilitÃ© financiÃ¨re de lâ€™entreprise.
<br><br>Vous Ãªtes avant tout un StratÃ©gique Visionnaire : vous aimez prendre du recul, observer les systÃ¨mes dans leur globalitÃ©, et identifier les leviers dâ€™amÃ©lioration. Vous refusez la routine, voyant la paie comme un processus Ã  faire Ã©voluer en continu. Votre capacitÃ© Ã  innover sâ€™appuie sur une base solide dâ€™organisation, indispensable pour concrÃ©tiser vos ambitions et transformer la stratÃ©gie en rÃ©sultats opÃ©rationnels.
<br><br><strong>âš ï¸ Pourtant</strong>, si vous nÃ©gligez les fondamentaux du quotidien â€” la maÃ®trise des calculs, le respect des Ã©chÃ©ances et la conformitÃ© â€” votre vision ambitieuse risque de rester thÃ©orique et sans impact concret.
<br><br><strong>ğŸ‘‰ Appuyez sur Â« Poursuivre pour recevoir le guide Â» pour saisir votre e-mail et recevoir votre guide complet.</strong>` },
      collaborateur: { title:"Vous Ãªtes : Collaborateur Discret et Fiable", body:`Le mÃ©tier de gestionnaire de paie repose sur une exigence absolue de confidentialitÃ© et de fiabilitÃ©. Vous traitez au quotidien des donnÃ©es sensibles : salaires, absences, contrats, informations personnelles prÃ©cises qui demandent un respect rigoureux des rÃ¨gles de confidentialitÃ©. Chaque salariÃ© doit pouvoir vous faire pleinement confiance, car une erreur ou une fuite dâ€™information pourrait entraÃ®ner des consÃ©quences lourdes tant humaines que juridiques.
<br><br>Vous Ãªtes avant tout un Collaborateur Discret et Fiable : sÃ©rieux, loyal et constant, vous Ãªtes la personne sur laquelle lâ€™entreprise sâ€™appuie pour assurer des paies justes, conformes et sÃ©curisÃ©es. Votre sens aigu de lâ€™Ã©quitÃ© vient renforcer ce statut, faisant de vous un acteur clÃ© dans la justice salariale au quotidien.
<br><br><strong>âš ï¸ Cependant</strong>, votre discrÃ©tion et votre modestie peuvent freiner la reconnaissance de vos compÃ©tences et limiter vos perspectives dâ€™Ã©volution professionnelle.
<br><br><strong>ğŸ‘‰ Appuyez sur Â« Poursuivre pour recevoir le guide Â» pour saisir votre e-mail et recevoir votre guide complet.</strong>` },
      curieux: { title:"Vous Ãªtes : Curieux Apprenant", body:`Le domaine de la paie est en constante Ã©volution : les lois changent rÃ©guliÃ¨rement, les conventions collectives sont mises Ã  jour, et les logiciels se modernisent sans cesse. Pour rÃ©ussir dans ce mÃ©tier dynamique, il faut absolument Ãªtre capable dâ€™apprendre en continu et dâ€™adapter ses connaissances au fil des nouveautÃ©s.
<br><br>Vous Ãªtes avant tout un Curieux Apprenant : vous aimez dÃ©couvrir, progresser et explorer de nouveaux savoirs. Cette curiositÃ© est un moteur puissant dans un environnement qui bouge sans cesse. Votre profil rÃ©vÃ¨le aussi une capacitÃ© naturelle Ã  communiquer et partager vos apprentissages, une qualitÃ© prÃ©cieuse pour Ã©voluer en Ã©quipe.
<br><br><strong>âš ï¸ Attention</strong> cependant : sans un plan clair et structurÃ©, vous risquez de vous disperser et de manquer de bases solides, ce qui pourrait ralentir votre progression.
<br><br><strong>ğŸ‘‰ Appuyez sur Â« Poursuivre pour recevoir le guide Â» pour saisir votre e-mail et recevoir votre guide complet.</strong>` }
    };

    /* Utils */
    function seedRng(seed){ let x=0; for(let i=0;i<seed.length;i++) x=(x<<5)-x+seed.charCodeAt(i)|0;
      return ()=>{ x^=x<<13; x^=x>>>17; x^=x<<5; return ((x>>>0)/4294967295); }; }
    function stableShuffle(arr, seed){ const rnd=seedRng(seed); return arr.map(v=>[rnd(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]); }
    function naiveSanitize(html){
      const tmp=document.createElement('div'); tmp.innerHTML=html;
      tmp.querySelectorAll('*').forEach(n=>{
        const allowed=['P','BR','STRONG','EM','UL','OL','LI','H2','H3','A'];
        if(!allowed.includes(n.tagName)) n.replaceWith(...n.childNodes);
        if(n.tagName==='A'){
          [...n.attributes].forEach(a=>{ if(a.name.startsWith('on')) n.removeAttribute(a.name); });
          const href=(n.getAttribute('href')||'').trim().toLowerCase();
          if(href.startsWith('javascript:')) n.removeAttribute('href');
          n.setAttribute('rel','noopener noreferrer'); n.setAttribute('target','_blank');
        }
      });
      return tmp.innerHTML;
    }

    /* Progress generic (email modal) */
    function animateProgress({fillId, labelId, target=90, duration=400}){
      const fill=document.getElementById(fillId);
      const label=document.getElementById(labelId);
      if(!fill||!label) return;
      const start=performance.now();
      const startVal=parseInt((fill.style.width||"0%").replace("%",""))||0;
      const endVal=Math.max(startVal,Math.min(100,target));
      function tick(now){
        const t=Math.min(1,(now-start)/duration);
        const value=Math.round(startVal+(endVal-startVal)*t);
        fill.style.width=value+"%";
        label.textContent=value+" %";
        if(t<1) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    }

    /* Rendu */
    const root = document.getElementById("lpf-quiz-root");

    function el(tag, attrs={}, children=[]){
      const n=document.createElement(tag);
      Object.entries(attrs).forEach(([k,v])=>{
        if(k==="class") n.className=v;
        else if(k==="html") n.innerHTML=v;
        else n.setAttribute(k,v);
      });
      (Array.isArray(children)?children:[children]).forEach(c=>{
        if(typeof c==="string") n.appendChild(document.createTextNode(c));
        else if(c) n.appendChild(c);
      });
      return n;
    }

    function renderStart(){
      root.innerHTML="";
      const card=el("div",{class:"lpf-card"});
      card.appendChild(el("h2",{},TEXT.start.title));
      TEXT.start.body.forEach(p=> card.appendChild(el("p",{},p)));
      const actions=el("div",{class:"lpf-actions"},[
        el("button",{class:"lpf-btn",type:"button"}, TEXT.start.cta)
      ]);
      actions.querySelector("button").addEventListener("click", renderInstructions);
      card.appendChild(actions);
      root.appendChild(card);
      actions.querySelector("button").focus();
    }

    function renderInstructions(){
      root.innerHTML="";
      const card=el("div",{class:"lpf-card"});
      card.appendChild(el("h2",{},TEXT.instructions.title));
      TEXT.instructions.ps.forEach(html => card.appendChild(el("p",{html: naiveSanitize(html)})));
      const actions=el("div",{class:"lpf-actions"},[
        el("button",{class:"lpf-btn",type:"button"}, TEXT.instructions.cta)
      ]);
      actions.querySelector("button").addEventListener("click", ()=>renderQuiz(0));
      card.appendChild(actions);
      root.appendChild(card);
      actions.querySelector("button").focus();
    }

    let answers=[]; let stepIndex=0;

    function renderQuiz(index){
      stepIndex=index; root.innerHTML="";

      /* Progression */
      const progWrap=el("div",{class:"lpf-progress"});
      const bar=el("div",{class:"lpf-progress-bar", role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-label":"Progression du quiz"});
      const fill=el("span",{id:"lpf-fill"}); bar.appendChild(fill);
      const liveLabel=el("div",{class:"lpf-progress-label","aria-live":"polite"}, el("span",{id:"lpf-label"},""));
      progWrap.appendChild(bar); progWrap.appendChild(liveLabel);
      root.appendChild(progWrap);

      const q=QUESTIONS[index];

      if(index===0)  root.appendChild(el("div",{class:"lpf-section-intro"}, TEXT.micro.a));
      if(index===4)  root.appendChild(el("div",{class:"lpf-section-intro"}, TEXT.micro.b));
      if(index===8)  root.appendChild(el("div",{class:"lpf-section-intro"}, TEXT.micro.c));

      const card=el("div",{class:"lpf-card"});
      const fieldset=el("fieldset");
      fieldset.appendChild(el("legend",{class:"lpf-question", id:q.id+"_legend"}, q.text));

      const optsWrap=el("div",{class:"lpf-options"});
      const prev=answers.find(a=>a.id===q.id);
      const opts=stableShuffle(q.options.slice(), q.id);
      opts.forEach((opt,i)=>{
        const id=q.id+"_opt_"+i;
        const labelEl=el("label",{class:"lpf-option", for:id});
        const radio=el("input",{type:"radio",name:q.id,id,"data-profile":opt.profile});
        if(prev && prev.profile===opt.profile){ radio.checked=true; labelEl.classList.add('is-checked'); }
        labelEl.appendChild(radio);
        labelEl.appendChild(el("span",{},opt.label));
        optsWrap.appendChild(labelEl);
      });
      optsWrap.addEventListener('change',(e)=>{
        if(!document.documentElement.classList.contains('no-has')) return;
        optsWrap.querySelectorAll('.lpf-option').forEach(l=>l.classList.remove('is-checked'));
        const lbl=e.target.closest('.lpf-option'); if(lbl) lbl.classList.add('is-checked');
      });

      fieldset.appendChild(optsWrap);
      card.appendChild(fieldset);

      /* Actions */
      const actions=el("div",{class:"lpf-actions lpf-actions--quiz"});
      const nextBtn=el("button",{class:"lpf-btn",type:"button"},"Continuer");
      const backLink=el("button",{class:"lpf-back-link",type:"button"},"Revenir");
      backLink.setAttribute("aria-label","Revenir Ã  la question prÃ©cÃ©dente");
      actions.appendChild(nextBtn);
      actions.appendChild(backLink);
      card.appendChild(actions);
      root.appendChild(card);

      /* Ã‰tats + events */
      backLink.disabled=(index===0);
      nextBtn.disabled=!(prev);
      card.addEventListener("change",(e)=>{ if(e.target && e.target.type==="radio"){ nextBtn.disabled=false; } });

      backLink.addEventListener("click", ()=>{ if(index>0) renderQuiz(index-1); });

      nextBtn.addEventListener("click", ()=>{
        const checked=card.querySelector("input[type=radio]:checked");
        if(!checked){
          nextBtn.setAttribute("aria-live","polite");
          nextBtn.textContent = "Choisissez une option pour continuer";
          setTimeout(()=> nextBtn.textContent="Continuer", 1400);
          return;
        }
        answers=answers.filter(a=>a.id!==q.id);
        answers.push({ id:q.id, block:q.block, profile: checked.getAttribute("data-profile") });
        if(index===3){ renderBreak("after4", index+1); return; }
        if(index===7){ renderBreak("after8", index+1); return; }
        if(index<QUESTIONS.length-1) renderQuiz(index+1);
        else renderFinalGate();
      });

      const pct=PROG[index]; fill.style.width=pct+"%"; bar.setAttribute("aria-valuenow", pct);
      const labelSpan=document.getElementById("lpf-label"); if(labelSpan) labelSpan.textContent=pct+" %";

      const firstRadio=fieldset.querySelector('input[type=radio]');
      if(firstRadio){ firstRadio.focus(); } else { card.setAttribute('tabindex','-1'); card.focus(); }
    }

    function renderBreak(which, nextIndex){
      root.innerHTML="";
      const p=PROG[nextIndex-1];
      const progWrap=el("div",{class:"lpf-progress"});
      const bar=el("div",{class:"lpf-progress-bar", role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":String(p),"aria-label":"Progression du quiz"});
      bar.appendChild(el("span",{style:"width:"+p+"%"}));
      const liveLabel=el("div",{class:"lpf-progress-label","aria-live":"polite"}, p+" %");
      progWrap.appendChild(bar); progWrap.appendChild(liveLabel);
      root.appendChild(progWrap);

      const data=TEXT.breaks[which];
      const card=el("div",{class:"lpf-card lpf-break"});
      const h=el("h3",{}, data.h);
      card.appendChild(h);
      card.appendChild(el("p",{}, data.t));
      card.appendChild(el("p",{}, data.s));
      const actions=el("div",{class:"lpf-actions"},[
        el("button",{class:"lpf-btn",type:"button"},"Continuer")
      ]);
      actions.querySelector("button").addEventListener("click", ()=>renderQuiz(nextIndex));
      card.appendChild(actions);
      root.appendChild(card);
      actions.querySelector("button").focus();
    }

    function computeScores(){
      const profiles=["gardien","organisateur","resolveur","communicant","expert","strategique","collaborateur","curieux"];

      // Comptages par bloc
      const blocks = { a:{}, b:{}, c:{} };
      profiles.forEach(p=>{ blocks.a[p]=0; blocks.b[p]=0; blocks.c[p]=0; });
      answers.forEach(ans => { blocks[ans.block][ans.profile] += 1; });

      // Normalisation par nb de questions / bloc
      const questionsPerBlock = { a:4, b:4, c:4 };
      const share = { a:{}, b:{}, c:{} };
      ["a","b","c"].forEach(bl => {
        profiles.forEach(p => { share[bl][p] = (blocks[bl][p] || 0) / questionsPerBlock[bl]; });
      });

      // PondÃ©ration
      const weighted = {};
      profiles.forEach(p=>{
        weighted[p] = WEIGHTS.a*share.a[p] + WEIGHTS.b*share.b[p] + WEIGHTS.c*share.c[p];
      });

      const argmax = (obj) => { let best=null, val=-1; for (const [k,v] of Object.entries(obj)){ if (v>val){ best=k; val=v; } } return best; };
      const domA = argmax(share.a), domB = argmax(share.b), domC = argmax(share.c);

      const maxV = Math.max(...profiles.map(p=>weighted[p]));
      const cands = profiles.filter(p=>weighted[p]===maxV);
      let global = cands[0];
      if (cands.length>1){
        if (domA && cands.includes(domA)) global = domA;
        else if (domB && cands.includes(domB)) global = domB;
        else if (domC && cands.includes(domC)) global = domC;
        else { for (const pr of TIE){ if (cands.includes(pr)){ global=pr; break; } } }
      }
      return { global, domA, domB, domC };
    }

    function renderFinalGate(){
      root.innerHTML="";
      const progWrap=el("div",{class:"lpf-progress"});
      const bar=el("div",{class:"lpf-progress-bar", role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"100","aria-label":"Progression du quiz"});
      bar.appendChild(el("span",{style:"width:100%"}));
      const liveLabel=el("div",{class:"lpf-progress-label","aria-live":"polite"},"100 %");
      progWrap.appendChild(bar); progWrap.appendChild(liveLabel);
      root.appendChild(progWrap);

      const data=TEXT.breaks.final;
      const card=el("div",{class:"lpf-card lpf-break"});
      const h=el("h3",{}, data.h);
      card.appendChild(h);
      card.appendChild(el("p",{}, data.t));
      const actions=el("div",{class:"lpf-actions"},[
        el("button",{class:"lpf-btn",type:"button", id:"lpf-open-email"}, "Voir mon rÃ©sultat")
      ]);
      actions.querySelector("button").addEventListener("click", renderResult);
      card.appendChild(actions);
      root.appendChild(card);
      actions.querySelector("button").focus();
    }

    function renderResult(){
      const s=computeScores();
      const R=RESULTS[s.global] || RESULTS.organisateur;

      root.innerHTML="";
      const card=el("div",{class:"lpf-card lpf-result"});
      const titleEl=el("h2",{}, R.title);
      card.appendChild(titleEl);
      card.appendChild(el("div",{class:"body", html: naiveSanitize(R.body)}));

      const actions=el("div",{class:"lpf-actions"},[
        el("button",{class:"lpf-btn",type:"button", id:"lpf-open-email"},"Poursuivre pour recevoir le guide")
      ]);
      card.appendChild(actions);
      root.appendChild(card);

      // Ouvrir le modal Ã  clic
      document.getElementById("lpf-open-email").addEventListener("click", openEmailModal);

      titleEl.focus();
      try{ window.dispatchEvent(new CustomEvent('lpf-quiz-finished',{detail:{profile:s.global, domA:s.domA, domB:s.domB, domC:s.domC}})); }catch(e){}
    }

    /* Init */
    renderStart();
  })();
  </script>

  <!-- ===== Modal Email ===== -->
  <div id="lpf-email-backdrop" class="lpf-modal-backdrop" aria-hidden="true"></div>
  <div id="lpf-email-modal" class="lpf-modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="lpf-email-title">
    <div class="lpf-dialog" role="document">
      <header>
        <h3 id="lpf-email-title">Recevez votre guide personnalisÃ© ğŸ“˜</h3>
        <button type="button" class="lpf-close" id="lpf-close-modal" aria-label="Fermer la fenÃªtre">Fermer</button>
      </header>

      <p>Entrez votre e-mail pour recevoir votre profil et le guide.
        <strong>(VÃ©rifiez bien l'adresse !)</strong></p>

      <input id="email" type="email" placeholder="Votre e-mail" style="padding:12px 14px;border:2px solid #000;border-radius:10px;width:100%;font-size:1rem;">
      <br>
      <button id="sendEmail" class="lpf-btn" style="margin-top:14px;">Envoyer mon profil</button>
      <div id="feedback" class="feedback" role="status" aria-live="polite"></div>

      <!-- Progression aprÃ¨s envoi -->
      <div id="progress-block">
        <div class="row">
          <div id="progress-bar">
            <span id="progress-fill"></span>
          </div>
          <div id="progress-label">0 %</div>
        </div>
        <p id="progress-text">Envoi en coursâ€¦</p>
      </div>
    </div>
  </div>

  <script>
    const emailInput = document.getElementById("email");
    const sendBtn = document.getElementById("sendEmail");
    const feedbackEl = document.getElementById("feedback");

    // Profil choisi
    window._lpfProfile = "";
    window.addEventListener("lpf-quiz-finished", (ev) => {
      window._lpfProfile = ev.detail?.profile || "";
    });

    async function sendEmail() {
      const email = (emailInput.value || "").trim();
      const profile = window._lpfProfile || "";

      // Validation simple
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i;
      if (!email) {
        feedbackEl.textContent = "Veuillez saisir votre adresse e-mail.";
        feedbackEl.style.color = "red";
        return;
      }
      if (!re.test(email)) {
        feedbackEl.textContent = "Adresse e-mail invalide. Exemple : prenom.nom@exemple.com";
        feedbackEl.style.color = "red";
        return;
      }

      sendBtn.disabled = true;
      emailInput.disabled = true;
      feedbackEl.textContent = "â³ Envoi en coursâ€¦";
      feedbackEl.style.color = "#555";

      // Affiche la barre de progression
      const pb = document.getElementById("progress-block");
      const pt = document.getElementById("progress-text");
      if (pb) pb.style.display = "block";
      if (pt) pt.textContent = "Envoi en coursâ€¦";

      try {
        const res = await fetch("/submit-email", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, profile })
        });

        let j = {};
        try { j = await res.json(); } catch { j = { ok:false, error:"RÃ©ponse serveur invalide." }; }

        if (res.ok && j.ok) {
          // 0 â†’ 90 %
          animateProgress({ fillId:"progress-fill", labelId:"progress-label", target:90, duration:800 });
          if (pt) pt.textContent = "Traitementâ€¦";

          // Final â†’ 100 %
          setTimeout(() => {
            animateProgress({ fillId:"progress-fill", labelId:"progress-label", target:100, duration:500 });
            if (pt) pt.textContent = "TerminÃ©";
            feedbackEl.textContent = "âœ… Presque fini ! VÃ©rifiez votre e-mail pour tÃ©lÃ©charger votre guide.";
            feedbackEl.style.color = "green";
            emailInput.value = "";
            setTimeout(() => { closeEmailModal(); }, 1200);
          }, 900);
        } else {
          throw new Error(j.error || "Impossible dâ€™envoyer vos donnÃ©es.");
        }
      } catch (e) {
        feedbackEl.textContent = "âŒ " + (e.message || "Erreur rÃ©seau. RÃ©essayez.");
        feedbackEl.style.color = "red";
        emailInput.disabled = false;
        sendBtn.disabled = false;
      }
    }

    sendBtn.addEventListener("click", sendEmail);
    emailInput.addEventListener("keypress", (e) => { if (e.key === "Enter") sendEmail(); });

    // ===== Modal controls =====
    const modal      = document.getElementById("lpf-email-modal");
    const backdrop   = document.getElementById("lpf-email-backdrop");
    const closeBtn   = document.getElementById("lpf-close-modal");
    let lastFocus    = null;

    function openEmailModal(){
      lastFocus = document.activeElement;
      document.body.classList.add("lpf-no-scroll");
      modal.setAttribute("aria-hidden","false");
      backdrop.setAttribute("aria-hidden","false");
      setTimeout(()=>{ const el = document.getElementById("email"); if(el) el.focus(); }, 0);
      document.addEventListener("keydown", trapTab);
    }
    function closeEmailModal(){
      modal.setAttribute("aria-hidden","true");
      backdrop.setAttribute("aria-hidden","true");
      document.body.classList.remove("lpf-no-scroll");
      document.removeEventListener("keydown", trapTab);
      if(lastFocus && typeof lastFocus.focus==="function") lastFocus.focus();
    }

    backdrop.addEventListener("click", closeEmailModal);
    closeBtn.addEventListener("click", closeEmailModal);
    document.addEventListener("keydown", (e)=>{ if(e.key==="Escape" && modal.getAttribute("aria-hidden")==="false"){ closeEmailModal(); } });

    function trapTab(e){
      if(e.key!=="Tab") return;
      const focusables = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      if(!focusables.length) return;
      const first = focusables[0], last = focusables[focusables.length-1];
      if(e.shiftKey && document.activeElement===first){ e.preventDefault(); last.focus(); }
      else if(!e.shiftKey && document.activeElement===last){ e.preventDefault(); first.focus(); }
    }
  </script>
</body>
</html>
